<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="cryptox0rprint打印出来的字符前32为iv的值然后就是分析encrypt函数 12345678910def encrypt(key, plaintext, iv):    ciphertext &#x3D; b&quot;&quot;    for i in range(0, len(plaintext), AES.block_size):        key_block &#x3D; aes_encr">
<meta property="og:type" content="article">
<meta property="og:title" content="xyctf 2024">
<meta property="og:url" content="http://example.com/2024/04/27/xyctf2024/index.html">
<meta property="og:site_name" content="rota">
<meta property="og:description" content="cryptox0rprint打印出来的字符前32为iv的值然后就是分析encrypt函数 12345678910def encrypt(key, plaintext, iv):    ciphertext &#x3D; b&quot;&quot;    for i in range(0, len(plaintext), AES.block_size):        key_block &#x3D; aes_encr">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-04-27T12:11:56.610Z">
<meta property="article:modified_time" content="2024-04-27T12:12:26.476Z">
<meta property="article:author" content="rota">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2024/04/27/xyctf2024/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>xyctf 2024 | rota</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">rota</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/04/27/xyctf2024/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rota">
      <meta itemprop="description" content="少年不惧岁月长，彼方尚有荣光在">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rota">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          xyctf 2024
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-04-27 20:11:56 / 修改时间：20:12:26" itemprop="dateCreated datePublished" datetime="2024-04-27T20:11:56+08:00">2024-04-27</time>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="x0r"><a href="#x0r" class="headerlink" title="x0r"></a>x0r</h2><p>print打印出来的字符前32为iv的值<br>然后就是分析encrypt函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def encrypt(key, plaintext, iv):</span><br><span class="line">    ciphertext = b&quot;&quot;</span><br><span class="line">    for i in range(0, len(plaintext), AES.block_size):</span><br><span class="line">        key_block = aes_encrypt(key, iv)</span><br><span class="line">        ciphertext_block = bytes(</span><br><span class="line">            [plaintext[i + j] ^ key_block[j] for j in range(AES.block_size)]</span><br><span class="line">        )</span><br><span class="line">        ciphertext += ciphertext_block</span><br><span class="line">        iv = key_block</span><br><span class="line">    return ciphertext</span><br></pre></td></tr></table></figure>
<p>inputs时,由于iv已知，相当于只用控制输入，<br>由于异或的性质并且key还是同一个key,直接把上面encrypt(key, flag, iv)的值输进去就能得到flag。<br>直接nc交互就能得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1.print</span><br><span class="line">2.input</span><br><span class="line">3.exit</span><br><span class="line">&gt; 1</span><br><span class="line">e0df4bcdec1ab90fb9806cee9da19c6dd6fafc9c3e5aeec755699fcdec8559a05dcd05715e53cbef188f741f63f12629e69096953bac1b80e19b4740899e3b6a</span><br><span class="line">1.print</span><br><span class="line">2.input</span><br><span class="line">3.exit</span><br><span class="line">&gt; 2</span><br><span class="line">iv: e0df4bcdec1ab90fb9806cee9da19c6d</span><br><span class="line">message: d6fafc9c3e5aeec755699fcdec8559a05dcd05715e53cbef188f741f63f12629e69096953bac1b80e19b4740899e3b6a</span><br><span class="line">58594354467b32313833303136622d396434612d346436312d396135612d3231346534353134623235347d0a04040404</span><br><span class="line"></span><br><span class="line">bytes.fromhex(&#x27;58594354467b32313833303136622d396434612d346436312d396135612d3231346534353134623235347d0a04040404&#x27;)</span><br><span class="line">b&#x27;XYCTF&#123;2183016b-9d4a-4d61-9a5a-214e4514b254&#125;\n\x04\x04\x04\x04&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="factor1"><a href="#factor1" class="headerlink" title="factor1"></a>factor1</h2><p>参考<a target="_blank" rel="noopener" href="https://link.springer.com/chapter/10.1007/978-3-319-40367-0_16#Sec7">论文的构造</a>,<br>论文里是对ed-k(p ^ 2-1)(q ^ 2-1)&#x3D;1进行维纳攻击，将维纳攻击中的N换成了N^2-9<em>N&#x2F;4+1<br>按照我的理解，它就相当于是用N来拟合(p ^ 2-1)(q ^ 2-1)(大概是这意思)<br>然后根据这个思路，将这题(p ^ 3 - 1)</em>(q ^ 3 - 1)进行变形，过程如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(p^3-1)*(q^3-1)</span><br><span class="line">=n^3-(p^3+q^3)+1</span><br><span class="line">=n^3-(p+q)*(p^2-n+q^2)+1</span><br><span class="line">=n^3-(p+q)*((p+q)^2-3n)+1</span><br><span class="line">=n^3-(n^0.5)*(n-3n)+1</span><br><span class="line">=n^3+2*n^1.5+1</span><br></pre></td></tr></table></figure>
<p>带入维纳攻击板子，计算得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">def transform(x,y):       #使用辗转相处将分数 x/y 转为连分数的形式</span><br><span class="line">    res=[]</span><br><span class="line">    while y:</span><br><span class="line">        res.append(x//y)</span><br><span class="line">        x,y=y,x%y</span><br><span class="line">    return res</span><br><span class="line">    </span><br><span class="line">def continued_fraction(sub_res):</span><br><span class="line">    numerator,denominator=1,0</span><br><span class="line">    for i in sub_res[::-1]:      #从sublist的后面往前循环</span><br><span class="line">        denominator,numerator=numerator,i*numerator+denominator</span><br><span class="line">    return denominator,numerator   #得到渐进分数的分母和分子，并返回</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">#求解每个渐进分数</span><br><span class="line">def sub_fraction(x,y):</span><br><span class="line">    res=transform(x,y)</span><br><span class="line">    res=list(map(continued_fraction,(res[0:i] for i in range(1,len(res)))))  #将连分数的结果逐一截取以求渐进分数</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line">def get_pq(a,b,c):      #由p+q和pq的值通过维达定理来求解p和q</span><br><span class="line">    par=gmpy2.isqrt(b*b-4*a*c)   #由上述可得，开根号一定是整数，因为有解</span><br><span class="line">    x1,x2=(-b+par)//(2*a),(-b-par)//(2*a)</span><br><span class="line">    return x1,x2</span><br><span class="line"></span><br><span class="line">def wienerAttack(e,n):</span><br><span class="line">    for (d,k) in sub_fraction(e,n):#用一个for循环来注意试探e/n的连续函数的渐进分数，直到找到一个满足条件的渐进分数</span><br><span class="line">        if k==0:                     #可能会出现连分数的第一个为0的情况，排除</span><br><span class="line">            continue</span><br><span class="line">        if (e*d-1)%k!=0:             #ed=1 (mod φ(n)) 因此如果找到了d的话，(ed-1)会整除φ(n),也就是存在k使得(e*d-1)//k=φ(n)</span><br><span class="line">            continue</span><br><span class="line">        if is_prime(d) and int(d).bit_length() == 512:</span><br><span class="line">            phi=(e*d-1)//k</span><br><span class="line">            return d,phi</span><br><span class="line">    </span><br><span class="line">e=172005065945326769176157335849432320425605083524943730546805772515111751580759726759492349719668775270727323745284785341119685198468883978645793770975366048506237371435027612758232099414404389043740306443065413069994232238075194102578269859784981454218948784071599231415554297361219709787507633404217550013282713899284609273532223781487419770338416653260109238572639243087280632577902857385265070736208291583497988891353312351322545840742380550393294960815728021248513046077985900158814037534487146730483099151396746751774427787635287611736111679074330407715700153025952858666841328055071403960165321273972935204988906850585454805923440635864200149694398767776539993952528995717480620593326867245714074205285828967234591508039849777840636255379730281105670496110061909219669860172557450779495125345533232776767292561378244884362014224844319802810586344516400297830227894063759083198761120293919537342405893653545157892446163</span><br><span class="line">n=99075185389443078008327214328328747792385153883836599753096971412377366865826254033534293886034828804219037466246175526347014045811852531994537520303063113985486063022444972761276531422538694915030159420989401280012025249129111871649831185047820236417385693285461420040134313833571949090757635806658958193793</span><br><span class="line"></span><br><span class="line">(d,phi)=wienerAttack(e,n^3-floor(2*sqrt(n))*n+1)</span><br><span class="line">#p+q = x,由上面推出的式子可列出</span><br><span class="line"></span><br><span class="line">x=var(&#x27;x&#x27;)</span><br><span class="line">f=n^3-x*(x^2-3*n)+1-phi</span><br><span class="line">f.solve(x)[-1]</span><br><span class="line">#x == 19967005847503923034507166918794965506267503428119552203292911361615132318903414819134103287113608735292986181147786515878575262609755277623932397581187246</span><br><span class="line">x=19967005847503923034507166918794965506267503428119552203292911361615132318903414819134103287113608735292986181147786515878575262609755277623932397581187246</span><br><span class="line">flag = &quot;XYCTF&#123;&quot; + hashlib.md5(str(x).encode()).hexdigest() + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">#XYCTF&#123;a83211a70e18145a59671c08ddc67ba4&#125;</span><br></pre></td></tr></table></figure>
<h2 id="factor3"><a href="#factor3" class="headerlink" title="factor3"></a>factor3</h2><p>做题思路也跟factor1差不多，只是最后m要用异或得到，以下是推的过程:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">phi=n**2+q*p**2+p**2+p*q**2+n+p+q**2+q+1</span><br><span class="line">=n**2+n*p+p**2+n*q+n+p+q**2+q+1</span><br><span class="line">=n**2+n*(p+q)+p**2+q**2+n+p+q+1</span><br><span class="line">=n**2+(n+1)*(p+q)+p**2+q**2+n+1</span><br><span class="line">=n**2+(n+1)*(2*floor(sqrt(n))+1)-n</span><br></pre></td></tr></table></figure>
<p>脚本如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">def transform(x,y):       #使用辗转相处将分数 x/y 转为连分数的形式</span><br><span class="line">    res=[]</span><br><span class="line">    while y:</span><br><span class="line">        res.append(x//y)</span><br><span class="line">        x,y=y,x%y</span><br><span class="line">    return res</span><br><span class="line">    </span><br><span class="line">def continued_fraction(sub_res):</span><br><span class="line">    numerator,denominator=1,0</span><br><span class="line">    for i in sub_res[::-1]:      #从sublist的后面往前循环</span><br><span class="line">        denominator,numerator=numerator,i*numerator+denominator</span><br><span class="line">    return denominator,numerator   #得到渐进分数的分母和分子，并返回</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">#求解每个渐进分数</span><br><span class="line">def sub_fraction(x,y):</span><br><span class="line">    res=transform(x,y)</span><br><span class="line">    res=list(map(continued_fraction,(res[0:i] for i in range(1,len(res)))))  #将连分数的结果逐一截取以求渐进分数</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line">def get_pq(a,b,c):      #由p+q和pq的值通过维达定理来求解p和q</span><br><span class="line">    par=gmpy2.isqrt(b*b-4*a*c)   #由上述可得，开根号一定是整数，因为有解</span><br><span class="line">    x1,x2=(-b+par)//(2*a),(-b-par)//(2*a)</span><br><span class="line">    return x1,x2</span><br><span class="line"></span><br><span class="line">def wienerAttack(e,n):</span><br><span class="line">    for (d,k) in sub_fraction(e,n):#用一个for循环来注意试探e/n的连续函数的渐进分数，直到找到一个满足条件的渐进分数</span><br><span class="line">        if k==0:                     #可能会出现连分数的第一个为0的情况，排除</span><br><span class="line">            continue</span><br><span class="line">        if (e*d-1)%k!=0:             #ed=1 (mod φ(n)) 因此如果找到了d的话，(ed-1)会整除φ(n),也就是存在k使得(e*d-1)//k=φ(n)</span><br><span class="line">            continue</span><br><span class="line">        if is_prime(d) and int(d).bit_length() == 320:</span><br><span class="line">            phi=(e*d-1)//k</span><br><span class="line">            return d,phi</span><br><span class="line">n = 913125842482770239379848062277162627509794409924607555622246822717218133091223291889541294440266178282194506242444509803611492259403578922020590849630191477864719052980160940803309686069818208833547621252544423652489179493083138385424424384165228024273745733240109761707533778691158938848158094054261174692601673435971526522219273943464877956131040249169850420336023942653021547841666224446678539579529590840999008107782784268926145671962239929431694391039559247</span><br><span class="line">e = 494518390582436635999115147756676313570637682518235195828939117782099618734167908630788943568232122157772909140885391963441876427590731524706959546524212914108888799081844320513851526790475333924396837458796755678072486028072639014677580265244176441153444956871730684233063789931539669072735599696830757690822185323538738397827461580678488181113667710378657058297572328491762536595872579603698945272140918157163640403488075948987156585480146162739943419183496337465468187233821931312507662218106713861638334075899266373256620752680354704533272722692596941861606161634082613228896420520465402725359166156632884432690715903666803067996854084671477445131853993177110154928274312496230096270510089973592664248613332000290545537840595645944390047611474888693558676781309912289044962293014118087259307560444929227407113819165713213046898243995956550944640168932947118400215917515277554126694376415569909534496134700668701465649939</span><br><span class="line">(d,phi)=wienerAttack(e,n**2+(n+1)*(2*floor(sqrt(n))+1)-n)</span><br><span class="line">c=4450931337369461482106945992542133557585962894030505065110870389112565329875502952762182372926117037373210509516570958483606566274369840551132381128665744266165792377925899683228751870742727716</span><br><span class="line">long_to_bytes(c^^(d**2))</span><br><span class="line">#b&#x27;XYCTF&#123;I_love_to_read_the_crypto_paper_and_try_to_ak_them&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="new-lcg"><a href="#new-lcg" class="headerlink" title="new_lcg"></a>new_lcg</h2><p>第一部分是二元lcg<br>推导如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s4=(1+a)*s3+(b-a)*s2 (mod p)</span><br><span class="line">s3=(1+a)*s2+(b-a)*s1 (mod p)</span><br><span class="line">#消去(b-a)得</span><br><span class="line">s1*s4-s2*s3=(1+a)*(s3*s1-s2^2) (mod p)</span><br><span class="line">#同理有</span><br><span class="line">s2*s5-s3*s4=(1+a)*(s2*s4-s3^2) (mod p)</span><br><span class="line">#消去(1+a)得</span><br><span class="line">(s2*s4-s3^2)*(s1*s4-s2*s3)-(s3*s1-s2^2)*(s2*s5-s3*s4) = 0 (mod p)</span><br><span class="line">#然后gcd这一坨和n得到p</span><br></pre></td></tr></table></figure>
<p>第二部分是EC-LCG，直接用现成的板子<br>完整脚本如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">c1=[6924229081976334180193477951417117275396656434968000032228908231511246053064833236257422745299036986875244562025221130619850904830372215788197314906896784,707045810464337488125013716300756405499020414540801863434513087687914538170573314824134496890600422837133767094273649381435979038909605432188919586751472,561487665739111774897165274560908487232457333748910467998343202097778699925650682704996443560224288857862513676706660506594465853704042586896087391214886,6498834369085375452441121562339384727357898216850540864190840194924515286757125433756518026123451611578553656133012172518080309106483207567929943790044792,5508345401684913940610183958526398635406187349043368834080838153611810896629693027245511688366776749176652858929409374912959736262162942801190344337268446,7604410082265211154108357446507297790451766698177313130672954202813796888988719242951127448112228332967892794819415211618572734294964346056056171483002307,7699815879242527638422887386550759485127768822609011364311314299885418068889791030639324882736871756700299169635780542149704586720216395186814592666988591,829748131720382599696653359722612708514830904084605048590882951300049701148883021283243506081300427041733299385325284399270633917941134488957784480285437,7084115400374950827522650500486495223539292992998875483730758098005030106055310282589342193536381973309924074043955222228738842206417828828756951777504457,7482796067314266426215648326036921955183807741134787613584977300821023398375789725848056657250086288687570875979072368004217788222537115232191230702833854]</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">p=gcd(((c1[2]*c1[4]-c1[3]^2)*(c1[1]*c1[4]-c1[2]*c1[3]))-((c1[3]*c1[1]-c1[2]^2)*(c1[2]*c1[5]-c1[3]*c1[4])),n)</span><br><span class="line">c2=[12573984103581521249597169818949825744876735847170990673204303602848066091917704946653820386665801380026230957120354174481948164514637637956459534723582285, 6441954407109995413858792101472089558106780628459991101662507565699664222341697230094798036088532393057448200220905589679548875702178737462785403325555226, 11684244745641367106386196774447204674089853123966422387024948921795099192025069760680924547214190425118261001002764397184950251157744938735586522727499550, 10396243416373326695473843427139385116708652845789644861965876346553795313454773668473030130335970707089781482749749170266279229263892370064669233541305377, 9090748241360606371310281608818966855338110969397659720953951845805983771894064629343960530245792700858927510839835850767728294266738917884471006979663157, 11489848045104749332790333272128633885019156159805805159750174723808043569789257625027794186359921080743368220606914862583644262009648261345452266067697628, 649349258009900424806913260265314442160901414078390702088746248078789581041616487825633046538335114117254875547413590064940767523651802950986197978665018, 6302136940345077947382276151657194124073457559487274425879887978386901058162385833414602346299055653879087077862824771863209271498552774720708307840705334, 5844526398244645236473089500608731415060125566027525405618000580381149761653744142808567706048834618328671311836990498943019718294135733114642775270792763, 4834548043993868659061606699822957422840040425976833628462093089330507589865407793951971491111695171201542345470702059513427268037868859282999222070054388]</span><br><span class="line">n=942554394956393500634473023924044851150783066435925660508624376974971108656861080872622432250172571195245180102507380675343264066303507696268870722959770362631674931170602993210221083436437860191861911457384526742569208842886612504579678703976889217504241741044075116270718940025586448491942058697669033418724145042156461740336592337509609124425828725269151627786668070531098444935129266626770404736852607352075247856808563388127774523912002202264558855255067503</span><br><span class="line"></span><br><span class="line">X=c2</span><br><span class="line">T = matrix(</span><br><span class="line">    ZZ,</span><br><span class="line">    [</span><br><span class="line">        [</span><br><span class="line">            2 * X[i] ^ 2 + 2 * X[i] * (X[i - 1] + X[i + 1]),</span><br><span class="line">            2 * X[i] - (X[i - 1] + X[i + 1]),</span><br><span class="line">            2 * X[i],</span><br><span class="line">            2,</span><br><span class="line">            (X[i - 1] + X[i + 1]) * X[i] ^ 2,</span><br><span class="line">        ]</span><br><span class="line">        for i in range(1, 6)</span><br><span class="line">    ],</span><br><span class="line">)</span><br><span class="line">q=gcd(T.determinant(),n)</span><br><span class="line">c=91351185520045025851535940537599785616890151570421939971146348618267656786110090770321857244701820126026227283965934212135946431643320325513590505155214070540638751565105300361430272638957420276596026161454413739823593506516275224444666187442238624864548263927274591212614561916913851855552516864387460946267629794664216228596534684933791607740725160394841711539767932339281214673649553407414347293480522175832736301571839298158011533849603878482322619858083471</span><br><span class="line">r=n/(p*q)</span><br><span class="line">phi=(r-1)*(p-1)*(q-1)</span><br><span class="line">d=inverse_mod(e,phi)</span><br><span class="line">long_to_bytes(int(pow(c,d,n)))</span><br><span class="line">#b&#x27;flag&#123;71fc0bc1-167a-43f0-ab0f-e0df3bea8ed3&#125;\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94\x94&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="反方向的密码-相思"><a href="#反方向的密码-相思" class="headerlink" title="反方向的密码 相思"></a>反方向的密码 相思</h2><p>由hash函数，如果已知message长度，那么填充后的message低位已知,低位已知就能用copper,<br>而message长度可以由爆破得到，然后再用copper得到flag,脚本如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from tqdm import *</span><br><span class="line">c=120440199294949712392334113337541924034371176306546446428347114627162894108760435789068328282135879182130546564535108930827440004987170619301799710272329673259390065147556073101312748104743572369383346039000998822862286001416166288971531241789864076857299162050026949096919395896174243383291126202796610039053</span><br><span class="line">n=143413213355903851638663645270518081058249439863120739973910994223793329606595495141951165221740599158773181585002460087410975579141155680671886930801733174300593785562287068287654547100320094291092508723488470015821072834947151827362715749438612812148855627557719115676595686347541785037035334177162406305243</span><br><span class="line">for i in trange(100):</span><br><span class="line">    h=hash(str(i))</span><br><span class="line">    h=bytes_to_long(h)</span><br><span class="line">    bits = h.bit_length()</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = (x*(2^bits)+h)^3 -c</span><br><span class="line">    f=f.monic()</span><br><span class="line">    roots = f.small_roots(X=2^(i*8),beta=0.4,epsilon=0.01)</span><br><span class="line">    if roots:</span><br><span class="line">        print(long_to_bytes(int(roots[0])))</span><br><span class="line">        break</span><br><span class="line">#b&#x27;XYCTF&#123;!__d3ng__hu0__1@n__3h@n__Chu__!&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="LCG-and-HNP"><a href="#LCG-and-HNP" class="headerlink" title="LCG_and_HNP"></a>LCG_and_HNP</h2><p>直接套<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/204846#h2-5">LCG_HNP的板子</a>,改改相关数据就行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">p=183640370379099520304414468793633666661</span><br><span class="line">a=36108041497607074474855679331694767924</span><br><span class="line">b=65925932211985158779695144876342622462</span><br><span class="line">m=p</span><br><span class="line">c=6003642257316152022364486167163125577018867662610595926973616937741281227891381713617380</span><br><span class="line">h = [0,34, 95, 100, 114, 16, 23, 17, 118, 115, 29, 73, 47, 12, 133, 78, 30, 30, 73, 87, 15, 85, 47, 20, 136, 6, 106, 74, 27, 116, 8]</span><br><span class="line">for i in range(len(h)):</span><br><span class="line">    h[i] &lt;&lt;= 120</span><br><span class="line">A = [1]</span><br><span class="line">B = [0]</span><br><span class="line">for i in range(1, len(h)-1):</span><br><span class="line">    A.append(a*A[i-1] % m)</span><br><span class="line">    B.append((a*B[i-1]+a*h[i]+b-h[i+1]) % m)</span><br><span class="line">A = A[1:]</span><br><span class="line">B = B[1:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">M = matrix(ZZ, 31, 31)</span><br><span class="line"></span><br><span class="line">for i in range(29):</span><br><span class="line">    M[i, i] = m</span><br><span class="line">    M[29, i] = A[i]</span><br><span class="line">    M[30, i] = B[i]</span><br><span class="line">    M[i, 29] = M[i, 30] = 0</span><br><span class="line">M[29, 29] =  1</span><br><span class="line">M[30, 30] = 2^120</span><br><span class="line">M[29, 30]= 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#print(B)</span><br><span class="line">vl = M.LLL()[0]</span><br><span class="line">l1 = vl[-2]</span><br><span class="line">h1 = h[1]</span><br><span class="line">s1 = l1+h1</span><br><span class="line">#s1 = a*seed+b %m</span><br><span class="line">seed = ((s1 - b)*inverse_mod(a,m))%m</span><br><span class="line">print(seed)</span><br><span class="line"></span><br><span class="line">class LCG:</span><br><span class="line">    def __init__(self, seed, a, b, p):</span><br><span class="line">        self.seed = seed</span><br><span class="line">        self.a = a</span><br><span class="line">        self.b = b</span><br><span class="line">        self.p = p</span><br><span class="line"></span><br><span class="line">    def next(self):</span><br><span class="line">        self.seed = (self.seed * self.a + self.b) % self.p</span><br><span class="line">        return self.seed &gt;&gt; (int(self.p).bit_length() - 8)</span><br><span class="line"></span><br><span class="line">lcg = LCG(seed, a, b, p)</span><br><span class="line">out = []</span><br><span class="line">for i in range(30):</span><br><span class="line">    out.append(lcg.next())</span><br><span class="line">key = &quot;&quot;</span><br><span class="line">while 1:</span><br><span class="line">    key += str(lcg.next())</span><br><span class="line">    if int(key).bit_length() &gt;= int(c).bit_length():</span><br><span class="line">        break</span><br><span class="line">long_to_bytes(int(key)^^c)</span><br><span class="line">#98265113854859913689289076942864611315</span><br><span class="line">#b&#x27;XYCTF&#123;2h1_21_ZHi_5h0u_yU_zI_xI3_l@0&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="happy-to-solve1"><a href="#happy-to-solve1" class="headerlink" title="happy_to_solve1"></a>happy_to_solve1</h2><p>这题是道<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_62506844/article/details/124256746">原题</a>，将脚本改改:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import sympy</span><br><span class="line">import libnum</span><br><span class="line">from tqdm import *</span><br><span class="line">n = 24852206647750545040640868093921252282805229864862413863025873203291042799096787789288461426555716785288286492530194901130042940279109598071958012303179823645151637759103558737126271435636657767272703908384802528366090871653024192321398785017073393201385586868836278447340624427705360349350604325533927890879</span><br><span class="line">c = 14767985399473111932544176852718061186100743117407141435994374261886396781040934632110608219482140465671269958180849886097491653105939368395716596413352563005027867546585191103214650790884720729601171517615620202183534021987618146862260558624458833387692782722514796407503120297235224234298891794056695442287</span><br><span class="line">e = 65537</span><br><span class="line">for r in trange(100000):</span><br><span class="line">    t1=(1&lt;&lt;512)-1+r</span><br><span class="line">    t2,s=gmpy2.iroot(t1**2-4*n,2)</span><br><span class="line">    if s:</span><br><span class="line">        p=(t1+t2)//2</span><br><span class="line">        q=n//p</span><br><span class="line">        d=gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">        print(long_to_bytes(int(pow(c,d,n))))</span><br><span class="line">        break</span><br><span class="line">#b&#x27;XYCTF&#123;3f22f4efe3bbbc71bbcc999a0a622a1a23303cdc&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="happy-to-solve2"><a href="#happy-to-solve2" class="headerlink" title="happy_to_solve2"></a>happy_to_solve2</h2><p>这题p中的数字都是123,q是456,直接搜索算法,然后rsa解密,脚本如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">n=697906506747097082736076931509594586899561519277373830451275402914416296858960649459482027106166486723487162428522597262774248272216088755005277069446993003521270487750989061229071167729138628583207229945902389632065500739730301375338674342457656803764567184544685006193130563116558641331897204457729877920989968662546183628637193220770495938729301979912328865798266631957128761871326655572836258178871966196973138373358029531478246243442559418904559585334351259080578222274926069834941166567112522869638854253933559832822899069320370733424453856240903784235604251466010104012061821038897933884352804297256364409157501116832788696434711523621632436970698827611375698724661553712549209133526623456888111161142213830821361143023186927163314212097199831985368310770663850851571934739809387798422381702174820982531508641022827776262236373967579266271031713520262606203067411268482553539580686495739014567368858613520107678565628269250835478345171330669316220473129104495659093134763261751546990704365966783697780787341963138501</span><br><span class="line">def find(p,q):</span><br><span class="line">    l = len(p)</span><br><span class="line">    print(l)</span><br><span class="line">    num = int(p)*int(q)</span><br><span class="line">    if (int(p)*int(q) % 10^l) != (n % 10^l):</span><br><span class="line">        return</span><br><span class="line">    if is_prime(int(p)) and len(p) == 512:</span><br><span class="line">        print(p)</span><br><span class="line">        pause()</span><br><span class="line">    find(&#x27;1&#x27;+p,&#x27;5&#x27;+q)</span><br><span class="line">    find(&#x27;1&#x27;+p,&#x27;6&#x27;+q)</span><br><span class="line">    find(&#x27;1&#x27;+p,&#x27;7&#x27;+q)</span><br><span class="line">    find(&#x27;2&#x27;+p,&#x27;5&#x27;+q)</span><br><span class="line">    find(&#x27;2&#x27;+p,&#x27;6&#x27;+q)</span><br><span class="line">    find(&#x27;2&#x27;+p,&#x27;7&#x27;+q)</span><br><span class="line">    find(&#x27;3&#x27;+p,&#x27;5&#x27;+q)</span><br><span class="line">    find(&#x27;3&#x27;+p,&#x27;6&#x27;+q)</span><br><span class="line">    find(&#x27;3&#x27;+p,&#x27;7&#x27;+q)</span><br><span class="line">#12121111312111223223122131311333233122132311113333112131132223222322113121112211311111122233111221112223111221331112322222333332331231122322123321123123133323213331321113332333332231113221231213322231322132311333132111221123111323112322131123322323331121233332123131222321123312221122323311122131121132332322222321213223131211322122311113331331222212121313131121212322112122212323321311231113213233312223111132133321123211122222213321223332322123131333322121223233122311222211311133331123122122331232313131221113</span><br><span class="line">p=12121111312111223223122131311333233122132311113333112131132223222322113121112211311111122233111221112223111221331112322222333332331231122322123321123123133323213331321113332333332231113221231213322231322132311333132111221123111323112322131123322323331121233332123131222321123312221122323311122131121132332322222321213223131211322122311113331331222212121313131121212322112122212323321311231113213233312223111132133321123211122222213321223332322123131333322121223233122311222211311133331123122122331232313131221113</span><br><span class="line">q=n/p</span><br><span class="line">e = 65537</span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line">d=inverse_mod(e,phi)</span><br><span class="line">c=153383826085102296581238539677668696644156148059026868813759015106139131297135097831661048493079405226972222492151356105759235749502324303047037349410709021152255315429280760639113724345836532087970918453353723090554450581657930847674930226113840172368662838756446364482977092478979838209396761279326533419699056209983721842484996150025403009644653678928025861445324715419893797015875541525590135843027312322236085581571452084477262582966972702577136904385741443870527205640874446616413917231260133364227248928492574610248881137364204914001412269740461851747883355414968499272944590071623223603501698004227753335552646715567802825755799597955409228004284739743749531270833084850113574712041224896044525292591264637452797151098802604186311724597450780520140413704697374209653369969451501627583467893160412780732575085846467289134920886789952338174193202234175299652687560232593212131693456966318670843605238958724126368185289703563591477049105538528244632434869965333722691837462591128379816582723367039674028619947057144546</span><br><span class="line">long_to_bytes(int(pow(c,d,n)))</span><br><span class="line">#b&#x27;XYCTF&#123;7f4b2241951976ce5ef6df44503209059997e5085d1bc21f6bef4d9effb29fd0&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="happy-to-solve3"><a href="#happy-to-solve3" class="headerlink" title="happy_to_solve3"></a>happy_to_solve3</h2><p><a target="_blank" rel="noopener" href="https://eprint.iacr.org/2008/228.pdf">论文题</a>,就是论文里的数据，照着论文的构造,还是用维纳的板子<br>,但是这题对精度要求挺高,用saegmath精度一直不够，就直接用的c++ GMP库,代码如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#输入的是9*n/2的值</span><br><span class="line">#include &lt;gmpxx.h&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">        mpz_t n,a;</span><br><span class="line">        mpz_init(n);</span><br><span class="line">        mpz_init(a);</span><br><span class="line">        gmp_scanf(&quot;%Zd&quot;,n);</span><br><span class="line">        mpz_sqrt(a,n);</span><br><span class="line">        gmp_printf(&quot;%Zd&quot;,a);</span><br><span class="line">        return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#g++ 1.cpp -o 1 -lgmp</span><br><span class="line">#./1</span><br><span class="line">#34370678879788026500641229307640148566742924269709689601862819788968061181867056589675727798365608492737982465643748867497088479646349337227931944784712559</span><br></pre></td></tr></table></figure>
<p>然后把这个数配合上面的论文以及维纳攻击脚本进行解密:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">def transform(x,y):       #使用辗转相处将分数 x/y 转为连分数的形式</span><br><span class="line">    res=[]</span><br><span class="line">    while y:</span><br><span class="line">        res.append(x//y)</span><br><span class="line">        x,y=y,x%y</span><br><span class="line">    return res</span><br><span class="line">    </span><br><span class="line">def continued_fraction(sub_res):</span><br><span class="line">    numerator,denominator=1,0</span><br><span class="line">    for i in sub_res[::-1]:      #从sublist的后面往前循环</span><br><span class="line">        denominator,numerator=numerator,i*numerator+denominator</span><br><span class="line">    return denominator,numerator   #得到渐进分数的分母和分子，并返回</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">#求解每个渐进分数</span><br><span class="line">def sub_fraction(x,y):</span><br><span class="line">    res=transform(x,y)</span><br><span class="line">    res=list(map(continued_fraction,(res[0:i] for i in range(1,len(res)))))  #将连分数的结果逐一截取以求渐进分数</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line">def get_pq(a,b,c):      #由p+q和pq的值通过维达定理来求解p和q</span><br><span class="line">    par=gmpy2.isqrt(b*b-4*a*c)   #由上述可得，开根号一定是整数，因为有解</span><br><span class="line">    x1,x2=(-b+par)//(2*a),(-b-par)//(2*a)</span><br><span class="line">    return x1,x2</span><br><span class="line"></span><br><span class="line">def wienerAttack(e,n):</span><br><span class="line">    for (d,k) in sub_fraction(e,n):#用一个for循环来注意试探e/n的连续函数的渐进分数，直到找到一个满足条件的渐进分数</span><br><span class="line">        if  N**0.323 &lt;= d &lt;= N**0.324:</span><br><span class="line">            print(d)</span><br><span class="line">            return d</span><br><span class="line">    print(&quot;该方法不适用&quot;)</span><br><span class="line">    </span><br><span class="line">e=202935305174706906986376186864051444100197589482194720650385604617995167023220940138899902073948844285283834058445151666398192104922822110762965750590312021079147170573038600118139119881722125346545331027913695559130179278058419339157557267195396326664433859683010193688491694572425231599139974726246205888139</span><br><span class="line">n=262520792590557046276663232446026434827811478251833823563978322470880473096166170973396967071440576532100045206129176936699321058518888771220060450723297988984995658582283884954240129867538637146924315603797818982078845855992582229939200744016516540207525916858674450616913948112117516831530578235916528257187</span><br><span class="line">c=66173406204647583141174847814283540389326401056490970592017577810775087017197392456634167609680060931553017712058528056769618111925816921272571306246667527546366331057781905353553621522209713637253380859235235590286779517552635935384231694255450099095196595516174794966487058693308544109311774074970769293357</span><br><span class="line">d=wienerAttack(e,n-34370678879788026500641229307640148566742924269709689601862819788968061181867056589675727798365608492737982465643748867497088479646349337227931944784712559+1)</span><br><span class="line">print(long_to_bytes(int(pow(c,d,n))))</span><br><span class="line">#7700666641276542480363234931129910864773105822871273281962364208727085458789318149203238548060738667</span><br><span class="line">#b&#x27;XYCTF&#123;68f1880cdafd99fbf9a156946cb39dd86477886f1d115636e149e12c16f99af0&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="重生之我要当oi爷-pro"><a href="#重生之我要当oi爷-pro" class="headerlink" title="重生之我要当oi爷 pro"></a>重生之我要当oi爷 pro</h2><p>这题参考了<a target="_blank" rel="noopener" href="https://github.com/PetePriority/picoctf-2024/blob/main/cryptography/flag_printer/solve.sage">国际赛的一道题目</a><br>,本来想着把n&lt;&#x3D;10调成n&lt;&#x3D;100能快点，最后发现其实差不多,都跑了几个小时</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">import multiprocessing as mp</span><br><span class="line"></span><br><span class="line">p = 1041231053</span><br><span class="line"></span><br><span class="line">X = []</span><br><span class="line">Y = []</span><br><span class="line">for line in open(&#x27;enc.txt&#x27;, &#x27;r&#x27;).read().strip().split(&#x27;\n&#x27;):</span><br><span class="line">    x, y = line.split(&#x27; &#x27;)</span><br><span class="line">    X.append(int(x))</span><br><span class="line">    Y.append(int(y))</span><br><span class="line"></span><br><span class="line">K = GF(p)</span><br><span class="line">R = PolynomialRing(K, &#x27;x&#x27;)</span><br><span class="line"></span><br><span class="line">def compZ(X):</span><br><span class="line">    x = R.gen()</span><br><span class="line">    Z = K(1)</span><br><span class="line">    for xk in X:</span><br><span class="line">        Z *= (x-xk)</span><br><span class="line">    return Z</span><br><span class="line"></span><br><span class="line">def comp(X, Y, Xother):</span><br><span class="line">    Z = compZ(Xother)</span><br><span class="line">    Y = [y/Z(x) for x, y in zip(X, Y)]</span><br><span class="line">    return Y, Z</span><br><span class="line"></span><br><span class="line">def solve(X, Y):</span><br><span class="line">    n = len(Y)</span><br><span class="line">    print(&quot;Solving for&quot;, n, &quot;points...&quot;)</span><br><span class="line"></span><br><span class="line">    # just use lagrange interpolation if the degree is small enough</span><br><span class="line">    if n &lt;= 10:</span><br><span class="line">        return R.lagrange_polynomial(list(zip(X, Y)))</span><br><span class="line"></span><br><span class="line">    nhalf = n // 2</span><br><span class="line"></span><br><span class="line">    X1 = X[:nhalf]</span><br><span class="line">    Y1 = Y[:nhalf]</span><br><span class="line">    X2 = X[nhalf:]</span><br><span class="line">    Y2 = Y[nhalf:]</span><br><span class="line"></span><br><span class="line">    # parallelize the computation of the two halves</span><br><span class="line">    if nhalf &gt; 10000:</span><br><span class="line">        with mp.Pool(2) as pool:</span><br><span class="line">            result1 = pool.apply_async(comp, (X1, Y1, X2))</span><br><span class="line">            result2 = pool.apply_async(comp, (X2, Y2, X1))</span><br><span class="line"></span><br><span class="line">            Y1, Z2 = result1.get()</span><br><span class="line">            Y2, Z1 = result2.get()</span><br><span class="line">    else:</span><br><span class="line">        Y1, Z2 = comp(X1, Y1, X2)</span><br><span class="line">        Y2, Z1 = comp(X2, Y2, X1)</span><br><span class="line"></span><br><span class="line">    # solve recursively</span><br><span class="line">    f1 = solve(X1, Y1)</span><br><span class="line">    f2 = solve(X2, Y2)</span><br><span class="line"></span><br><span class="line">    # put it back together</span><br><span class="line">    return f1*Z2 + f2*Z1</span><br><span class="line"></span><br><span class="line">def test():</span><br><span class="line">    Xt = X[:1000]</span><br><span class="line">    Yt = Y[:1000]</span><br><span class="line">    f = solve(Xt, Yt)</span><br><span class="line">    for x, y in zip(Xt, Yt):</span><br><span class="line">        assert f(x) == y</span><br><span class="line"></span><br><span class="line">test()</span><br><span class="line"></span><br><span class="line">f = solve(X, Y)</span><br><span class="line"></span><br><span class="line">open(&quot;flag.bmp&quot;, &quot;wb&quot;).write(bytearray(f.coefficients(sparse=False)[:-1]))</span><br></pre></td></tr></table></figure>
<p>最后整出来一张图片,flag在左上角</p>
<h2 id="Random-rr"><a href="#Random-rr" class="headerlink" title="Random_rr"></a>Random_rr</h2><p>这题前半部分是随机数预测，直接用python的MT19937Predictor,<br>后半部分是原题，参考了<a target="_blank" rel="noopener" href="https://tangcuxiaojikuai.xyz/post/d4b677a0.html">大佬</a>的脚本，<br>最后完整脚本如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">final = []</span><br><span class="line"></span><br><span class="line">from hashlib import md5</span><br><span class="line">from mt19937predictor import MT19937Predictor</span><br><span class="line">n = 472993274721871037103726599805149366727531552333249750035977291933239067588481589544777397613192273114354221827196579379954069925604091911249655707080927769808587176515295614018992848517984372306879552247519117116110554431341268358177159108949791969262793325836353834899335531293329721598226413212541536002401507477776699642647348576111445702197483449777741566350285229621935507081895389023444249054515395783080003733803406382744631528246608154546123270319561514117323480441428953306734274538511770278887429407127143049023747710881993279361892937905382946820141513009017756811296722630617325141162244806884220212939955235410280899112731530527048274396186038160728562551536558223235783656985493518204710943916486379681906506757757594165379493317173050550893487151879681122510523721157284728808336110950008840684602353984682117748018347433177541603140491131603068512706893984834735290809952944273565203183330739252949245209529232254867201402656024997949207918675051941911990640248052951780195402390132237903538546705181463959793972284823588987652138458328270662652334799233015314673544813649692428544375538627858921763941533600553536579901589575693816746953261108022490849251974419402753031545629158199093099096735356165044275617408697</span><br><span class="line">rr = 11898141078345200236264081467585899457224809417108457314508072413792599039332439547789237898270544336909458761754683941320649771736625000667170176071314483</span><br><span class="line">ks = [1462227062794249126369859823370329795444295554631867449122519463903085153603985900680740216206168716423777588580245877886440288748604020630699018542826979566965387039050150069523167528973701117587082189067128448763762233651697690088165126309640643249893980922783446939093480513501423929380273397400708296781344423099729594996935151205635124630966978346265570102760841188859706856157965455490428917432012469015925570881840242441646984344205989934223312311722527845, 17436088264981004997841810232705191434707487036117316568031039310756229463817709762330626096875057666532776781413031682988478368320631200639484646124749334955850093397553177978996330881043557698983399584498223222105144624884205328876488334329130830465297477669138121963831402080876078357077714205039964108868193841782271495425644463200232523492344001660692840819160127541347575190224749912289543698786833926857916729347030739521501971908837887266088602825603179428932500122868635833564921115729380769315969449959847532694279060981180556955413680421245680949817931938812637093078177255366095925596232172597647804659446, 169559415577702492912881115171844374594897133030580223300760597578879930554761809414648409965790290108683744070236827542547112767931390381215817208191241194452401715396697138137182840759511035487717013487364495797652031544286820278750675326239062595892448739046788242584477837603604028584783800711126256213550041835365566067529075264741159242623075137208552904103323636912832758118607742414554050834861661347524996361121876885982545956793412777613516967651789645670837406737788560923095674100190720996844931263803247711890541497769408802573382496173181275896304033554412089516486158308042512557770316390458745235174270820619821158359708588836275104941171089532593072639298996037834372691067497283819036389853616602440038642702961597540965107104661813887585271108258467582, 353291124480685802122760873619558181197925748758526501461956322344713145481696018545548833112663130052221102526199589136442461136617134139228771440873303781403752812631064169836368616974931324935659661616432397250323791027357698736360780111349622044193849460721756463896782586060025792712427344165223388631274105033257953386232975622550466772244070538660725769821337872161112606157590652531598571409049763994992112562965984307203582687185746063109802744989804265169651236595150092278455325980064053498109201539606445526852506504951020231421164201055246981085535835484260199043182412639045612970769228962343363308833437852540654614315024696428638587640053405690902605225272716392141318356689485996722112797193445203157167283359129296847476836010747322296658815494204920904679373943240361056289263055689989853602794079068762252790541020355479732830748629340531275553956346072236216251442369981439899969148055895199797337493316, 15179303239962972288090709923258186951958171456436855682777477692171617505348532247047242658368307257431505429176030938743052282481669819891838891541215477308429612423006023438195430836574000543742809228546430000091179899316856488547218901706415026288318088205302049807334703045024896255849147262301854988225565498235577522563864689394270282449494777293613090615435735306391538191861818216934248371120219493426168505800995544058108910908179783162033445093246274431640068273309491502382851514221655427718436104350319852529981208352415296770552441024164515192550794244703092453886081781025084452892498434750021938722777929757172650087934502975720197724550995892550276217204632074271485875928952811717435969392225184804651569530492559664256153442664382496786312755369567453642365570522203867667064702855064117777248996452839510530112258447365219153330364325480082364302480271013963043808407808026617207478317657335771085499907980998058580300198585325142615450209133083897393551483195987009899057506802305527262738968147264513649676062280043385168050292062437784343481003416836360329, 104314025112423274137233712089887942843544143270638359212971052274128269239471444157192816218808079846611202214084249469627150795706839411653429768726632207799788014550224322493762432406192490957609286668132611092680358220234900446241372261756133560546933898911405464919838498505955386741631220042481687693247513434548162014035705016381807652211578605534090062861927303094187322830394428003720849259122728764020582018050036758593860110512593538102856625101436236685192028585785277359733026956010177985114124809725271266235518425292300207754430093643901348424098723963444965623388363705031341005891153453971749807676104809873756494951980451522602316873491452723525098105304097227244362803315664527459814806074055296007282695273078439762481309737546526713550861490435485841202437290236273820499123268038887900937637888673263245804550050225236201356152470642062093953920448272200600863673489805148880500648543349624355627609552339313652249538084845763001317045938369921466480729660920730443079784782692236767617383867121962635468379178835807692901877341892412552450901873955386866840632105626000662355131829735238309392134598804443268332424263236647235664725585301289855948091012922650578186399459695913486992557308313400835129903295472, 4343840077241661846268935044680587301922553038527003445558194299629246437770144538620877381238906692028249854972040151877119476048349008469539245051594012783879085195059417005760769680951795800991838280644405366143799108863486512837967757384337716585187068737628553329955797218927948991807398217726158890043209786493155396314350961622153611660511283644242391666275370968989005241503828383899735010790229677725184129352599961733027673035747501574385230757945287667652891580150423322079486963198642876365246595747082980621374167798723795545482544349625906607527172146616536749758514128592808962495027958181278487153055495228539745094046329616245517171769643273537017191271548980274132500153620316208900769372928143878394476769232210760910446165114726727346459588121745157883051053172477968719246421056145184230282266693069367823549866560055702512612897427682313787206166585448900167833527105055197710187205451619052189815465364328045147326853372540758120163941655690535948810941959546749120505801600233689886118090477238999842117697450804442045413189286597419777550661497797676126492038567180797469427287581550651480006192621101368344597554817693129617367587265330631435038864934907358392135820575836786357021588185619258824320681971817694708190104082162236078675439624893099574428154391060852816948575281188326664739692492957173855447270784701674993602965772572705572236661284175838750276, 33232188464261655563179500532261332740673268011927651630320348613939386668276216461522230721806580297413734568274970935459682942632905228878109266134442095157849521426423087852309281434787500339731212538950209119002423508188676963099974651225610558899243654721531277558550493327350452829753190227897808568073543678269898207509403265336445740620238191925668387207191570780928973245140015529624527394339504110166219539275461482559378890285009329265175900569903390034280071197123026951890243045598372762777194271518734277493717862068019851753397533687634966545727487904367806612431117675184708993348444665119927999157611733751268566184403876833185469516137451908620375918418813671459671015165252098516843945558856771686910403711604755349007547521956309000907909321344073563215005461926587582952949359614987174889724241132421264477252674765866525922832869625858802619129860030857164098812287559445509108640318149480136605636205337149260208047286736509632239281682602528730811378780178290081953095940304361016309200367801327179710042344212586894803008913891990437132132154254944818304511848018157641226316486358816741537666493766664969385708412966038685156129617636758707978377511764106375364810771789547724915964400747168477073598611228354770053945278770974453529085850122110633659583211141893829685722257824029598188511772787791704436267726687275674340238387313917520001746093685584958790950657401396602667943161883455431709467342749040393470692558305012064228847045344065542300917341497880086951027085764240682050347639183710265265174608568581, 444779920211605528457399163778798302264962864500581879449061229089239557061028178632115126869104894859226622560444516783454331855728643653865605416497057611218192216553619406318123596530221714071025603907837449777716507496519968322248412164964314856154515711925650355367893348523307966596574094376371033024957143232394835676102505384939927310874548633276763683911796494980021115548783946752097475837673376331732397502955289357489918575906500096508563791334858578196054364575510262549227364768636710590870090347574179185730720326430135005745433229085504757196383182089273767249820043995239845148428050144582143617569531992315827635029452027206779513658792594533984308575410806115812027902735755703109725290139038156207495514857551309765646867686889984088386887429907974093388131425361751082756577755914020028802552784669428525627343682049455098817841762010840270014859394810253384211716918791183946657609375093285440242734069437770190190813413589772304378568548089845839766313942144795085022405996403115650259032402819679689834193687730312737088900035185810701229565183457677574983602078058685068344436316207621825755389502057132478973466812474466361405511892936227130460055637816125221120263639554189413490859455156262013094121152711225170530206766029467454109467305401401846460468093777715624211347060013862325763649394914935407437210178038317290293919361423759769343159231891689139655490453425886071219512994202371899835337440763173124439640514220811318874946924703189200447691715469272243497270647235873464259786562267062001636730421451659510209634262617060501219332722128011149714434675517928550498574212874429311999930642838137400894349532393752915440919307741932816838690395606129263401130, 7602657349299010857087412189053904610014835470031847851883656349200899897074907434799227128793882909815738193292999732731888978083302895341590290406257165745016960805038897127665671830799203429105439046544232550057709873279272509500788880966204623301536523568757142788616714342396835348896652095993273120352216558215593487864297089604696564960677302089801831232789103069985778444311388865194583877243016764859298874263207514989622286824950955134805871171552294553075628653085978727480483509447782713038101591216015129434695340034230885326874585545666722007375755217543974918948104058213162198622707539613172458718150254646150294432030411829433714905174414616923009739539225989262351006787760054622647363592552091025438151580366414103445836645659713990402360169403016672502089016488614454624878982485618028646781661937237681350359808210590576468884385972827124881157769458685969004277110291444619196405001534224888721294643753150729204059438079951844348808565383170513314781032113884141668626087014977362543472261224194658720773278314480331562064521903562028929772245246023044918780612944818960063465178711539798601604042918647125400052489298307932451350609822767956789584605169244797260390089496546479886501231620453426723358141585623383732719446553408376039010770786422589076208046136110959032740167791347231308499822725649244370210435390174503003095419480360405606956944343844737311175070859345840892142099028930344584283138344997292575870767828146422997758547138227712103360348602516685557024226449188853398358276132193649977284120887692434143592539192811494203655959855535383027295793357853938962196086241223840647731695273486642076372427955673144634441281545597498351950046381851656586528708237353884336502685431879297832928729212632646314921058694911651155140211366665485536218812420299903213130769617228499207211355651173115373832276702819917, 84264285782731568162877315100957489042921709978064128681351268312087746569277269486245900009777400169887830271723552358655565447593550146955011831050100818215000508691318113595184405583164046098487595114378660143656870174865126611342542042359190092909153954755450866325242940723529598062222899187359928557844177883049590925651498994463750219753412624841866695746278533280094878847475236701017015819139013181859456526369446971330754812310385508018904191327621492159168820784532796330689921699298448074204812463376397381282323119448865011664447416851175564248969000702694318145335362835482058897168517488161967391334177372697703315388808719141005307789457461912851355132825731054246686755461163054191160703614564317990818604434605413936738139726767800963911739280012496306857434637923374480459728565199969705867209254398601345461449150134011614149873500167983320745189254670021733091744167981087834156449345560645456017335407633688885028006913440590401180339340613693275890333649989994343631183579024732181147263210054753733928915807504572214832934722959416211618552311628264441740006263506928574652072303741962304773970001278403931114817733924209744938397932123215729579525983133592585604481836441256004482294972680139829929612014077833332681473454850703790455910234390018139844986977475904490461864701830158535403553678623812164036013559496102371103327886019446045373299153105962515417300141416878319759519389540938146354852993808369804508844242989928184577744636058484630309125804687764207122455205953467056765480238519667329086954915863584834116160428194118255018588109352554311335461224660821734294806261011545470878130619510996578906865491369421849868743287382195889612248362671647411387033198694140556943015854769888065336118318462104334038850907108272666824691321243254155599118711741561988645703051401242347980726593263524750481061186510425684386819376145632247818469939222055128225225680599982324030716227856712465076900465158037591919290264095582887285060549164180202017670962738795868581166749, 86875322477430958180737121081750310417552562568937472111462285494068077044224883282734365519155742412567742579384640688864318774506290688726649362821127869025823526558190891391368772700819437828837459806248988365684079824273784568628472269256575474035185709547347651993828702097549741334374364807937523943589572886556418546138161477442285095981598112603569341799645993286627117775387075506854483018231019196901947857611575841702330988975450215180893407629689116208362182111134678579611569697431926172879405158644545853375597102146456828749129737059398592090470207221930164907529449914731078780527501106015075222892079609819142004929517650214077829963858911041047626149998836986070729125260139028680402532903187215589441565748744974914634384575746331436503499349361029226889115930910170650991829637232214683931349631413139076186550993209917767820494311457665926894684877305970805039969582722809409057884485422798810134923124618610122219627418825157655548696504402394251875250216209088386596839289090205455355830326463145513637140192806838161127837601889645337809125003492037067870634529636104813436961659217629590299188696646907180990318511335172435862882285594729483438730028804396906143686407113299921602779063868388165847291926366314379673487291861917979020712234162374569910970226596823115360201748087179946804305525598669650976080327154187180758461602309422875784085236535569730334773176739598656049048170461638432200220436248431274572686422522379720157015816524948018313551155878299198696729645812418550240418562460968434597425565276688472550697127256796390159826046074365566403255645195972270118195562599397495009632518911353576570958767630794735474661250425256764192128158589944999335063602995713281667673220224066976800182326927451684095263096450327503087613798593569273550869670074927576509772147487168451681956168877773772760560498198909642263656809675890678191288443016329637625633073593034921242604872479828009991046383160941673220022936977188891725330716968754725864852252393788824966035242075304806536640145214252474418277831012513594308952183851343958969850677298051187040013011759593833806518361877966381266531975488250988830914527197364101, 12512746540434506671622137154487272479684301796741804852784466276118318939301642459078381853231258719083628458347218300308117654564963998239910113998177176145693597297093613404613373790353962391872079537076763899617842035568892498763955045462691124784114867824842208398619557012590225397311703746359043524766454656517843775988786861851276648768563329960194176509861369794873055457605566481169738163028805838726245153501259733517437071411250664053003146288253452678594410757071147688309902950173685554263072263315677468119998237322488014934897657616287531839226555887811741614460852594517274931125186552830901907056814814364537922270306184144816527619368461860735029130410855453249885989873125086119053183377748071520492963343904276809950936122217011456932719335145019854799217844683275916251254411759723367406995497382110560047670724344385060716483035502136838796674166618447372318994376720742190789098253575402714952812659933854943786548064525033834188130429821475033759906784746466100360319090217901641302494652036828536156345999295944207311903908579168517843644212223034389569172093947663228241575508427027088548956357607118349234005954956185598117597472201788146015733232957686350215358611056864787006128071212201859644019363381882103578216957110324101802774053325622415064181605199128828290427210592657379567354577480538732546950307498243047731412124485919082022649710227773753299708907420377570860905912772090222116049362619789689065827376289781835174416236170541192824551498867290178284835242340226614885213085297034699023207334693204443834177633980478287732765627349487390651101805889417613406850491982522373652059294595205056982377527663490663856624298132703619405155068989422975395069609806200717991260670611916599446743505075260280455301127997860556855773088502432536965641419712974469765402344889497455850368646912720700712406187148014080534412935202873400913358906387215078903911309526903672652336133008199048483053203616435313691633319058270312626100467991257715266040851461069620411861732977165671779365665772314236597023035647614424138241559672376552675319414807273488451981119673616629216737966281726964723616994609707694019677386869057732381647985259361201436431774138127924914503212637589804812882400769493547225221791707699401249315407469433861394473469478007958068015775562155959407640271035, 8708772086314275150137563047822324600135662221530061604490923488781196834561031216119766508710300439592586098337033648172158478037428422016638015261006654452028325941079516640378163094114359263904509663697697446450829644183714138570138053299079111099978730162273301464139950471846002885912898793623780911069208262571511170830772519224286142285588233365329150597172851602037056835267890472296625561911616145092230018104567552026345101742597268103327522556484095066615892886223565058357363680363535631942614863586767642475310674520180258183502370763782154430809207907408245635540513317210636762204031484268471851140728225200408406477879491421034411771595550287534644492458168126531514396470443302572852034873709549055869547530655956369042654261333529517571359153739442787262860093740661118519451621018435524810049086927689546375333874177211297659402716374232772574921960004351227056283357373573456626553641214672035447396850649297539465342595024155246359918811294045883925114447310675847751632815638598802360958589640694941216735143869543493813631906641446867757344570346832228628926669569641235390679032157550781745139542693343976899951858605641387961226781860479580622706408871423958897669045935376111333791269969907893321496309204776813332733513920276388085041994007557204267637656364577970814757016037506402807507663275686948184629913418881333357288030576799576733495401166943446587740185387874828772125373722620767643073868513719861621143440955960613060364895903611801265463530162601221089578458698304546551933625165213065587195349408747310822367615685148092899114446129224352042234315865770543693346677200293484242331181710417082363209828386909100998998888639900536186820795298321286714108461675397032864388542110213210827364423163325349547591341479159200210127489502278231430650721377665744894470461939053982524090875574789651853588962397719426413835176058841208314719781852021952695059793831541054574871680705012400864629090745303863048197498118155019461006670125137061405464976922277176269488571398394629261276128473896794210626729855368774199524936087915252643083350806653978162434973122894687105799198912067140963567030871513363285565713597188757003358857092315759659368775879258759880919191003344516366609757523241375325301693755640462733509474415702644254270875174073203609818099246161951619877073996976627155333499346477458629618081495288947853190429723736471113704267980053978389993182103772852202476116179106939188158462552458652108321980165243577989, 600670032931697501164308145888014197492570434182237560158362504047400318743985557099146474331125213856150404793770533457208418057346330441677143608228832189090853249915025345091440471977572520377721353552421230209210878714408072035504562082229497678931477951277415656323261513473676851714174232119110952631892409156281805902829840067360861715042158260954202580085062540987292060373485291126788640037325353253582263912429148264582730931166497761524857603024286533377786733733569503217095911870554634981195459051734711257551318783862993538532061516918229242512785148483203666879172553287417202171558010581931339490420944579378230441427075256586289381172933294401587550551868745979621899498946185449116142910195187754784531077545817750030440559239594200572501795505647816820925940699189807911408560014741609936565474163109147615538288077368434085501495660339791023107653834631734799739401195331082524762689829404043854362928974818455326969933539941993127168162613893714556812406931262398133232164550840686759286879519200522303631666340760585955445333243578595829239195345013932609791828394260147075352440178009791316103080071026057431465935054583990885807722362958473601534263884483797804520563080119843829936517581710475224995487406412704094626227661853966476374689727423649602092208013642493973696165953898208578723428386172214500367650457610332358123936218429284291631085293746168516063238704669713654100448973473107547290896972051178145687724778934856166935295480879225802399479077346027327314330339492654814903821691676533513420126315351413897998334933276481425781316933061160336396245725800475529909180155168951048807842776329370733724945778641650510054608686950632422179126803289332576361096595524712081770649946303450447653874189205658344800236157548893404541684986435295108661952487239009695950009496079506381196591935645314690427759872790821975631216132209928929354223296595481820239561580620161078572691513920025180731146443551810374070796784563832569069540610771634802811283644303060748631402280436293606074124845116433560780371614622560694771710506136314406382632695962443912413902134325317328060708301892967007571381754948796760722223816096248930178117187568894324829422197591098693433015570587292619159140504205675563120383480457405492676888099039922054652604691220210221980510833810667665873272200431377635693722100801416566512889633584494029920362450447581541351127279435858414431885445382278645820452301854483001535497815948240428726604118517960146521827602352741617814422650606656703172306618878677224079000419335204662784233051630328692085443396990051814696765167700904476881356841198817297213897315038, 16802200282185468546709956092597774740677661549186109526956115242473121883967931163131646187704424819015848998645400207990914089013740921040117435052153841770979793783160919446710908856026577921822303736856837341534046856200378566367573847587481842033197417244157615430123019293064402352517730950287717412467467865654183120580805017956735624709774788608215096623799957840473617022005811932787883583498153009349216019520591315741115282954188920266939008472763372248700697866120997747281838993436471646694877967037584713292557154069090849429661358360669249141411401563354311865086301325223201338603660585063135197133579821848197298915130533944228373462645556131332664180638837298172981687095294316288287474397100963640912775346092923086826604630609655904543259441330900502644107449819662176812660489691326329405408557397950478553867742426469439899689820127149948041436799921133103166748621889384866646157787616184868217116001323368301878471584588973680319019047080248726830275150507574175166679909676797693790108124055103246880427997452475987304179562314626608037471679968401792562140826537740199515244895441348559877458197387323837253170889409923432265627983693113613925422770696270052261532295092167140744798998616784973950454662490861686686088097664631333759768155114942862532519746034900590201459240562835926241941887144381202153705241903628166984657567323072355632922438685555213721062141830979317585407175747781177680148572415131107678588710821046069788978524572240303124373546329950302755883009871688891897763945611072996185025629828607383345003927868697847599452468428107980542821610672736393669832455756995387290606284835293616942665638848969022879828703775592928644725559259945529304050112289143946763124018433851771902626785481385869955110673938215223622863613678412315324306153440766902206001688838913230436350171971289551619865068519200736270652193304810653015371888594169504114520468603987418351580463962583790787745908309177358777801427510313483309516938585851407176405272323275406264541269998648558076115710572739949113174179063104037408892800012305672645293826133157192205750448664938758484140537975600112928783731131731160554472918720908169457539285420601699964488745103603485765360051670848460168635009550254451173622724686795853530317243637913985666214527422655976232855531815124677038149005239212580323707459514903671850604938595975480625971419288321333482646971954799306704972896590507695031753549266109898497496991269990475759448688581247659517684220339086012734812415537965920455360852739093844076811759759173303373454199660054006117215442176739570999154607921395801738324345694513716171731402600767074759488172948500119306978382635362273371756452203795420879806823382694171689272398990752964743539328906992588078386684970091097095002524822271111900103]</span><br><span class="line">c1 = 363788646363430038957594782766177313516930410013028761096125449525352900311987342432332707389678725464245570305442656091083147693929633253905472222223119105496597576680892700795690978029583841539541374381306488238546636925041645743837795052980068923686651284191050257037214462852085566417008362992641640639862428112228493556483476170926590723955399664612288121797929235261679990399185352352544286959163976884867676390120340127790862048627561021372508575978346406322179713972665443056495181281314029605259955375166316993493231524529034376084736285226932730392410446057610167031627686895389188357267336304140707750661551754532703726810046229782522509583068679068266026330534604220136448779670239303044844594369863033342562614954908580980797071779438702134548396966154384817728024762723793272143181635940946334888845065820620182286804643281323447179363272699368386379953273502775010659085362938622805062632668642982294663858335244396163857338508227323801751681995976156487970781553331051080424612021398707159108830544940316009623664909356175231889874464365926612039289520439021685692867423908585449824825323639525381296026274686349117857285659369998795553471936274903352010099265109629071229881541531543477669574187083631324785284254322</span><br><span class="line">c2 = 408184822131518156560324293475775283916865330287271026174896526350123511666895281956297307670862799857291692050125369779347444868678108319280695068081984027607535529170555137883873801205238074937937942433229726545428621408643537931796698659949811571615439710035675674461716185346635792745790874541046465708604310892716226150611709100803537856333225160587696062166931121471905405372834167788843039506170303362597157739646424300148724721973787617390725217064863182798206515059995025139870581046657455818390197378360718268577414540468313327849155326977072599665355467818781585456624519602844435476444300792593181233725708809256956289242348798772583396011536497809799519543692707372931861510836406771810916160714625641110048105945905698555148489134800297890071585166636593108936219686471652288476546797128397632673886639590166634763861905600305344338904568157848336645918449260801970498973364463883003344546391045331665345600454985730993059182020185438557159428617482719829271986950641093353253897984198499501965120625507862855814501340943227107501804839977088104677785444986972836309787440401273632064782837200999263612507784233705263545942160822597103292282242714942650302979883274746718391358487897324158260429570732440514025523470979</span><br><span class="line">with open(&quot;random.txt&quot;, &quot;r+&quot;) as fp:</span><br><span class="line">    lines = fp.readlines()</span><br><span class="line">line = [int(_.strip()) for _ in lines]</span><br><span class="line">Predictor = MT19937Predictor()</span><br><span class="line">for i in range(648):</span><br><span class="line">    Predictor.setrandbits(line[i], 32)</span><br><span class="line">key = Predictor.getrandbits(32)</span><br><span class="line">key1= int(str(key)[0])</span><br><span class="line">#part1 dlog by p-adic</span><br><span class="line">final = []</span><br><span class="line">for i in trange(16):</span><br><span class="line">    R = Zp(rr, prec=i+key1)</span><br><span class="line">    x = (R(ks[i]).log() / R(69).log()).lift()</span><br><span class="line">    final.append(x-key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#part2 HGCD</span><br><span class="line">def HGCD(a, b):</span><br><span class="line">    if 2 * b.degree() &lt;= a.degree() or a.degree() == 1:</span><br><span class="line">        return 1, 0, 0, 1</span><br><span class="line">    m = a.degree() // 2</span><br><span class="line">    a_top, a_bot = a.quo_rem(x^m)</span><br><span class="line">    b_top, b_bot = b.quo_rem(x^m)</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a_top, b_top)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    q, e = c.quo_rem(d)</span><br><span class="line">    d_top, d_bot = d.quo_rem(x^(m // 2))</span><br><span class="line">    e_top, e_bot = e.quo_rem(x^(m // 2))</span><br><span class="line">    S00, S01, S10, S11 = HGCD(d_top, e_top)</span><br><span class="line">    RET00 = S01 * R00 + (S00 - q * S01) * R10</span><br><span class="line">    RET01 = S01 * R01 + (S00 - q * S01) * R11</span><br><span class="line">    RET10 = S11 * R00 + (S10 - q * S11) * R10</span><br><span class="line">    RET11 = S11 * R01 + (S10 - q * S11) * R11</span><br><span class="line">    return RET00, RET01, RET10, RET11</span><br><span class="line">    </span><br><span class="line">def GCD(a, b):</span><br><span class="line">    print(a.degree(), b.degree())</span><br><span class="line">    q, r = a.quo_rem(b)</span><br><span class="line">    if r == 0:</span><br><span class="line">        return b</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a, b)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    if d == 0:</span><br><span class="line">        return c.monic()</span><br><span class="line">    q, r = c.quo_rem(d)</span><br><span class="line">    if r == 0:</span><br><span class="line">        return d</span><br><span class="line">    return GCD(d, r)</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f1 = sum(k*x**i for i, k in enumerate(final))^(127) - c1</span><br><span class="line">f2 = x^(65537) - c2</span><br><span class="line">f2 = f2 % f1</span><br><span class="line">res = GCD(f1,f2)</span><br><span class="line"></span><br><span class="line">m = -res.monic().coefficients()[0]</span><br><span class="line">flag = long_to_bytes(int(m))</span><br><span class="line">print(flag)</span><br><span class="line">#b&#x27;XYCTF&#123;ba76e13f-269e-4481-baf0-4a50ad17f891&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="Complex-dlp"><a href="#Complex-dlp" class="headerlink" title="Complex_dlp"></a>Complex_dlp</h2><p>复数域下的离散对数问题,而复数域可以映射到R^2上,所以这题就转换成实数域上的dlp,而p-1是光滑的，所以用Pohlig-Hellman算法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">def babystep_giantstep(g, y, p, q=None):</span><br><span class="line">    if q is None:</span><br><span class="line">        q = p - 1</span><br><span class="line">    m = int(q**0.5 + 0.5)</span><br><span class="line">    # Baby step</span><br><span class="line">    table = &#123;&#125;</span><br><span class="line">    gr = 1  # g^r</span><br><span class="line">    for r in range(m):</span><br><span class="line">        table[gr] = r</span><br><span class="line">        gr = (gr * g) % p</span><br><span class="line">    # Giant step</span><br><span class="line">    try:</span><br><span class="line">        gm = pow(g, -m, p)  # gm = g^&#123;-m&#125;</span><br><span class="line">    except:</span><br><span class="line">        return None</span><br><span class="line">    ygqm = y                # ygqm = y * g^&#123;-qm&#125;</span><br><span class="line">    for q in range(m):</span><br><span class="line">        if ygqm in table:</span><br><span class="line">            return q * m + table[ygqm]</span><br><span class="line">        ygqm = (ygqm * gm) % p</span><br><span class="line">    return None</span><br><span class="line"></span><br><span class="line"># Pohlig–Hellman法</span><br><span class="line">def pohlig_hellman_DLP(g, y, p):</span><br><span class="line">    crt_moduli = []</span><br><span class="line">    crt_remain = []</span><br><span class="line">    for q, _ in factor(p-1):</span><br><span class="line">        x = babystep_giantstep(pow(g,(p-1)//q,p), pow(y,(p-1)//q,p), p, q)</span><br><span class="line">        if (x is None) or (x &lt;= 1):</span><br><span class="line">            continue</span><br><span class="line">        crt_moduli.append(q)</span><br><span class="line">        crt_remain.append(x)</span><br><span class="line">    x = crt(crt_remain, crt_moduli)</span><br><span class="line">    return x</span><br><span class="line"></span><br><span class="line">g = 3^2+7^2</span><br><span class="line">y = 5699996596230726507553778181714315375600519769517892864468100565238657988087817^2+198037503897625840198829901785272602849546728822078622977599179234202360717671908^2</span><br><span class="line">p = 1127236854942215744482170859284245684922507818478439319428888584898927520579579027</span><br><span class="line"></span><br><span class="line">x = pohlig_hellman_DLP(g, y, p)</span><br><span class="line">print(long_to_bytes(x))</span><br><span class="line">#b&#x27;___c0mp13x_d1p_15_3@5y_f0r_y0u___&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="Sign1n-签到"><a href="#Sign1n-签到" class="headerlink" title="Sign1n[签到]"></a>Sign1n[签到]</h2><p>由于它这custom_add是可逆的，照着逆向一下就行,脚本如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">def custom_add_re(input_str):</span><br><span class="line">    input_list = list(input_str)</span><br><span class="line">    length = len(input_list)</span><br><span class="line">    </span><br><span class="line">    for i in range(length):</span><br><span class="line">        input_list[i] = str((int(input_list[i]) - i - 1) % 10)</span><br><span class="line"></span><br><span class="line">    result = &#x27;&#x27;.join(input_list)</span><br><span class="line">    return result</span><br><span class="line">b=12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567891134567790012455778912234677900124456899113346778001344568890233467780112346788902234677801124557789023355788001245578891223467790113445778012235578800124457889112346778011245567991223557880012355689902335667990124556799122355788001244578890233467780112455778902335568900123556899112346778902344578801233467789112355779912234577990233556780113</span><br><span class="line">input_str=custom_add_re(str(b))</span><br><span class="line">def swap_bits(input_str):</span><br><span class="line">    input_list = list(input_str[2:])</span><br><span class="line">    length = len(input_list)</span><br><span class="line"></span><br><span class="line">    for i in range(length // 2):</span><br><span class="line">        temp = input_list[i]</span><br><span class="line">        input_list[i] = input_list[length - 1 - i]</span><br><span class="line">        input_list[length - 1 - i] = temp</span><br><span class="line"></span><br><span class="line">    return &#x27;&#x27;.join(input_list)</span><br><span class="line">leak=swap_bits(input_str)</span><br><span class="line">print(leak)</span><br><span class="line">#&#x27;101100001011001010000110101010001000110011110110011100001100001011001000011100101100001011001100110011000110010001011010011010001100001001101100110010000101101001101000110011001100001001100100010110100111001001101110110001100110110001011010110000101100110011000100011100001100110011000100011001001100101011000100011011000110001011000110111110100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#x27;</span><br><span class="line">#后半0手动删除,得到flag</span><br><span class="line">long_to_bytes(int(&#x27;1011000010110010100001101010100010001100111101100111000011000010110010000111001011000010110011001100110001100100010110100110100011000010011011001100100001011010011010001100110011000010011001000101101001110010011011101100011001101100010110101100001011001100110001000111000011001100110001000110010011001010110001000110110001100010110001101111101&#x27;,2))</span><br><span class="line">#b&#x27;XYCTF&#123;8ad9aff2-4a6d-4fa2-97c6-afb8fb2eb61c&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="babyRSAMAX"><a href="#babyRSAMAX" class="headerlink" title="babyRSAMAX"></a>babyRSAMAX</h2><p>数论推导题,(p+q)^e二项展开后模n,只有p^e+q^e，再配合p^e-q^e,用gcd就能分解n,后面就是两次RSA解密，<br>但是最后一次，由于e&#x3D;4096,直接在p有限域开根<br>脚本如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">n = 39332423872740210783246069030855946244104982381157166843977599780233911183158560901377359925435092326653303964261550158658551518626014048783435245471536959844874036516931542444719549997971482644905523459407775392702211086149279473784796202020281909706723380472571862792003687423791576530085747716706475220532321</span><br><span class="line">gift1 = 4549402444746338327349007235818187793950285105091726167573552412678416759694660166956782755631447271662108564084382098562999950228708300902201571583419116299932264478381197034402338481872937576172197202519770782458343606060544694608852844228400457232100904217062914047342663534138668490328400022651816597367310</span><br><span class="line">gift2 = 111061215998959709920736448050860427855012026815376672067601244053580566359594802604251992986382187891022583247997994146019970445247509119719411310760491983876636264003942870756402328634092146799825005835867245563420135253048223898334460067523975023732153230791136870324302259127159852763634051238811969161011462</span><br><span class="line">c = 16938927825234407267026017561045490265698491840814929432152839745035946118743714566623315033802681009017695526374397370343984360997903165842591414203197184946588470355728984912522040744691974819630118163976259246941579063687857994193309554129816268931672391946592680578681270693589911021465752454315629283033043</span><br><span class="line">y = 1813650001270967709841306491297716908969425248888510985109381881270362755031385564927869313112540534780853966341044526856705589020295048473305762088786992446350060024881117741041260391405962817182674421715239197211274668450947666394594121764333794138308442124114744892164155894256326961605137479286082964520217</span><br><span class="line"></span><br><span class="line">p=gcd(gift1+gift2,n)</span><br><span class="line">q=gcd(gift1-gift2,n)</span><br><span class="line"></span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line">t = 65537</span><br><span class="line">d = inverse_mod(t,phi)</span><br><span class="line">x = pow(y,d,n)</span><br><span class="line">long_to_bytes(int(x))</span><br><span class="line"></span><br><span class="line">#b&#x27;XYCTF&#123;e==4096&#125;&#x27;</span><br><span class="line"></span><br><span class="line">e=4096</span><br><span class="line">PR.&lt;x&gt;=Zmod(p)[]</span><br><span class="line">f=x^e-c</span><br><span class="line">f.roots()</span><br><span class="line">#刚好解就在这里面</span><br><span class="line">#[(166353789373057352195268575168397750362643822201253508941052835945420624983216456266478176543306949701450304802363434626984929302798183530544471602540368154,</span><br><span class="line">  1),</span><br><span class="line"> (36344540379246669047243921781711114415694316462518391812884210045, 1)]</span><br><span class="line"># long_to_bytes(36344540379246669047243921781711114415694316462518391812884210045)</span><br><span class="line">#b&#x27;XYCTF&#123;Rabin_is_so_biggggg!&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="fakeRSA"><a href="#fakeRSA" class="headerlink" title="fakeRSA"></a>fakeRSA</h2><p>这题初看还是挺高级的，其实就是线性代数问题，将function函数转为以下式子:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A=matrix(GF(p),[[9,0,-36],[6,0,-27],[0,1,0]])</span><br><span class="line">x=matrix(GF(p),[[69],[48],[52]])</span><br><span class="line">#function函数就相当于是A^n*x</span><br></pre></td></tr></table></figure>
<p>然后将A对角化，得到A&#x3D;P<em>G</em>(<del>P),将A^n<em>x化为P</em>G^n*</del>P<em>x&#x3D;y,<br>继续化简得到G^n</em><del>P*x&#x3D;</del>P<em>y<br>观察G^n可以发现G对角线上都是3^n而G[0][1],G[1][0]&#x3D;n</em>3^n-1,利用这性质求出n，完整脚本如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">A=matrix(GF(p),[[9,0,-36],[6,0,-27],[0,1,0]])</span><br><span class="line">x=matrix(GF(p),[[69],[48],[52]])</span><br><span class="line">y=matrix(ZZ,[[1431995965813617415860695748430644570118959991271395110995534704629241309597572003500157255135707], [1011565891130611736600822618382801465506651972373410962205810570075870804325974377971089090196019], [784497518859893244278116222363814433595961164446277297084989532659832474887622082585456138030246]])</span><br><span class="line">G,P=A.jordan_form(transformation=True)</span><br><span class="line"># 3^n*((~P*A*x)[2][0]) == (~P*y)[2][0] mod p</span><br><span class="line">n1=((~P*y)[2][0]/((~P*A*x)[2][0]))%p</span><br><span class="line"># 3^n*((~P*A*x)[1][0])+n*3^n-1*((~P*A*x)[2][0]) == (~P*y)[1][0] mod p</span><br><span class="line">n2=(((~P*y)[1][0]-n1*((~P*A*x)[1][0]))/((~P*A*x)[2][0]))%p</span><br><span class="line">n=(3*n2/n1) % p</span><br><span class="line">long_to_bytes(int(n))</span><br><span class="line">#b&#x27;XYCTF&#123;y0u_finally_f0und_t3h_s3cr3ts!!|&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="Sign1n-Revenge"><a href="#Sign1n-Revenge" class="headerlink" title="Sign1n_Revenge"></a>Sign1n_Revenge</h2><p>跟Sign1n[签到]是一样的思路</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="EZ-Base1024-2"><a href="#EZ-Base1024-2" class="headerlink" title="EZ_Base1024*2"></a>EZ_Base1024*2</h2><p>מಥൎࢺଳɫअΥٻଯԢڥիɺ୦ࢸЭਘמۊիɎඥࡆڣߣಷܤҾয౽5<br>如题base2048</p>
<p>在线网站解码XYCTF{84ca3a6e-3508-4e34-a5e0-7d0f03084181}</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/04/20/crypto/" rel="prev" title="crypto学习笔记">
      <i class="fa fa-chevron-left"></i> crypto学习笔记
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#crypto"><span class="nav-number">1.</span> <span class="nav-text">crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#x0r"><span class="nav-number">1.1.</span> <span class="nav-text">x0r</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#factor1"><span class="nav-number">1.2.</span> <span class="nav-text">factor1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#factor3"><span class="nav-number">1.3.</span> <span class="nav-text">factor3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#new-lcg"><span class="nav-number">1.4.</span> <span class="nav-text">new_lcg</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8D%E6%96%B9%E5%90%91%E7%9A%84%E5%AF%86%E7%A0%81-%E7%9B%B8%E6%80%9D"><span class="nav-number">1.5.</span> <span class="nav-text">反方向的密码 相思</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LCG-and-HNP"><span class="nav-number">1.6.</span> <span class="nav-text">LCG_and_HNP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#happy-to-solve1"><span class="nav-number">1.7.</span> <span class="nav-text">happy_to_solve1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#happy-to-solve2"><span class="nav-number">1.8.</span> <span class="nav-text">happy_to_solve2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#happy-to-solve3"><span class="nav-number">1.9.</span> <span class="nav-text">happy_to_solve3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E8%A6%81%E5%BD%93oi%E7%88%B7-pro"><span class="nav-number">1.10.</span> <span class="nav-text">重生之我要当oi爷 pro</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Random-rr"><span class="nav-number">1.11.</span> <span class="nav-text">Random_rr</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Complex-dlp"><span class="nav-number">1.12.</span> <span class="nav-text">Complex_dlp</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sign1n-%E7%AD%BE%E5%88%B0"><span class="nav-number">1.13.</span> <span class="nav-text">Sign1n[签到]</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#babyRSAMAX"><span class="nav-number">1.14.</span> <span class="nav-text">babyRSAMAX</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fakeRSA"><span class="nav-number">1.15.</span> <span class="nav-text">fakeRSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sign1n-Revenge"><span class="nav-number">1.16.</span> <span class="nav-text">Sign1n_Revenge</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MISC"><span class="nav-number">2.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#EZ-Base1024-2"><span class="nav-number">2.1.</span> <span class="nav-text">EZ_Base1024*2</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">rota</p>
  <div class="site-description" itemprop="description">少年不惧岁月长，彼方尚有荣光在</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">rota</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container_site_pv">总访问量<span id="busuanzi_value_site_pv"></span>次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">总访客数<span id="busuanzi_value_site_uv"></span>人</span>
    <span class="post-meta-divider">|</span>
<!-- 不蒜子计数初始值纠正 -->
<script>
$(document).ready(function() {

    var int = setInterval(fixCount, 50);  // 50ms周期检测函数
    var countOffset = 20000;  // 初始化首次数据

    function fixCount() {            
       if (document.getElementById("busuanzi_container_site_pv").style.display != "none")
        {
            $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + countOffset); 
            clearInterval(int);
        }                  
        if ($("#busuanzi_container_site_pv").css("display") != "none")
        {
            $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + countOffset); // 加上初始数据 
            clearInterval(int); // 停止检测
        }  
    }
       	
});
</script> 


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
